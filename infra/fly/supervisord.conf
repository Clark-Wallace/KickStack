[supervisord]
nodaemon=true
user=appuser
logfile=/app/logs/supervisord.log
pidfile=/app/logs/supervisord.pid

[program:caddy]
command=/usr/local/bin/caddy run --config /etc/caddy/Caddyfile
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/caddy_error.log
stdout_logfile=/app/logs/caddy.log
priority=100

[program:postgrest]
command=/app/scripts/start-postgrest.sh
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/postgrest_error.log
stdout_logfile=/app/logs/postgrest.log
priority=200

[program:gotrue]
command=/app/scripts/start-gotrue.sh
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/gotrue_error.log
stdout_logfile=/app/logs/gotrue.log
priority=200

[program:fngw]
command=node /app/api/fngw/dist/server.js
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/fngw_error.log
stdout_logfile=/app/logs/fngw.log
priority=300
environment=NODE_ENV="production"

[program:realtime]
command=node /app/api/realtime/dist/server.js
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/realtime_error.log
stdout_logfile=/app/logs/realtime.log
priority=300
environment=NODE_ENV="production"

[program:web]
command=node /app/web/.next/standalone/server.js
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/web_error.log
stdout_logfile=/app/logs/web.log
priority=400
environment=NODE_ENV="production",PORT="3001"